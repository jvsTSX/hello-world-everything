# Texas Instruments Digital Complex Sound Generator
Part number SN76489 and shortened to DSCG, this rather simple sound chip is present in a wide number of home computers and home video game consoles trough the second and third generations, still appearing a few times on the 4th generation in form of its 'SEGA PSG' variant.

## Specs
- 4 sound channels.
  - 3 square wave channels.
  - 1 pseudo-random noise channel.
- Sixteen volume levels for each channel.
- Compact I/O, only needing one memory address to be controlled.

## Interfacing And Registers
The DCSG has eight internal registers but you don't have a typical memory-mapped register pool, instead you communicate a kind of packet or command format into its single 8-bit, write-only I/O port.
```
SCCRDDDD
||||||||
||||++++------- Data
|||+----------- Register select
|++------------ Channel select
+-------------- Start new transfer or continue 2-byte transfer
```

Depending on the channel being tone or noise and whether you want to change volume or frequency may cause your register write command to be only one byte or two bytes, such as represented on the table below:
|Byte Sequence|Register Name|
|-|-|
|`1000LLLL` `0-HHHHHH`| Tone Channel 1 Frequency |
|`1001VVVV`| Tone Channel 1 Volume |
|`1010LLLL` `0-HHHHHH`| Tone Channel 2 Frequency |
|`1011VVVV`| Tone Channel 2 Volume |
|`1100LLLL` `0-HHHHHH`| Tone Channel 3 Frequency |
|`1101VVVV`| Tone Channel 3 Volume |
|`1110-SFF`| Noise Channel Control |
|`1111VVVV`| Noise Channel Volume |

With each bit on the fields having the meaning of:
- **L**: 10-bit frequency Low half.
- **H**: 10-bit frequency High half.
- **V**: 4-bit volume attenuation, a value of '0' is the loudest setting while a value of 'F' is mute. The curve of the volume is logarithmic, meaning that its decay to silence sounds more natural than that of a linear volume chip.
- **S**: Noise control Size: Controls if the noise channel emits noise or a tone, more info below.
- **F**: Noise control Frequency select: sets one of three pre-defined frequencies or use channel 3's frequency.

## Square wave channels
Channels 1 trough 3 emit square waves, their frequencies are generated by a 10-bit clock divider timer, of which you can calculate the frequency of by taking the base clock rate of the chip, dividing it by 16 and dividing by a value ranging from 1 to 1024, since this channel generates a square wave with a flip-flop, it effecitively divides the frequency by two. The square waves cannot be phase reset and new writes to the frequency values only take effect after the previous internal counter value expires.

Pitch formula: `Frequency = Base Clock / 16 / 10-bit Period / 2`

## Noise channel
The most elaborate of the 4 channels, it consists of mostly a 15-bit shift register and a XOR gate, and can operate in two ways based on the "**S**" bit:

- **Noise mode**: When **S** is 1, the XOR gate taps the last two bits of the shift register, which turns it into a linear feedback shift register (LFSR), resulting in a very uniform noise sound with a period of 32767.
- **Rotate mode**: When **S** is 0, the contents of the shift register simply rotate around forever, resulting in a 15-step waveform that takes the pattern of the shift register's initial value.

Unlike the square wave channels, the noise channel only has four selectable frequency sources:

|**F** bit combination|Frequency Source|
|-|-|
|00|Master/512|
|01|Master/1024|
|10|Master/2048|
|11|Channel 3|

The first three settings divide the master clock source of the sound chip by the numbers specified in the table above, while the 4th setting uses the square wave channel 3's frequency as a clock (before the flip-flop) and effectively divides it by 15, this mode is very useful for bass as most systems clock this chip in a way that the square wave channels' frequencies are too high to achieve good bass range frequencies.

You can reset the phase of the noise channel by changing the **S** bit, causing the shift register to be loaded with its initial value of `%1000 0000 0000 000`.

## Links
[Grauw's website mirror of the official SN76489 datasheet](https://map.grauw.nl/resources/sound/texas_instruments_sn76489an.pdf)